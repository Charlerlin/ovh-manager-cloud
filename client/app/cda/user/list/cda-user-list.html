<section>
    <header>
        <p data-translate="cda_user_permission_definition"></p>
    </header>
    <div>
        <button type="button"
                class="oui-button oui-button_secondary"
                data-ng-click="CdaUserListCtrl.openAddModal()"
                data-ng-if="!CdaUserListCtrl.loading">
            <span data-translate="cda_user_add_button_text"></span>
        </button>
    </div>
    <div class="text-center" data-ng-if="CdaUserListCtrl.loading">
        <oui-spinner></oui-spinner>
    </div>
    <oui-datagrid rows="CdaUserListCtrl.datas.users">
        <oui-column title="'cda_user_table_col_username' | translate" property="user.name" sortable></oui-column>
        <oui-column title="'cda_user_table_col_key' | translate" property="user.key" sortable></oui-column>
        <oui-column title="'cda_user_table_col_pool' | translate" property="pools" sortable>
            <span data-ng-repeat="pool in $row.pools | limitTo: CdaUserListCtrl.options.maxPoolDisplay track by pool.poolName">
                        {{ pool.poolName }}{{ !$last || CdaUserListCtrl.isTruncatedPoolArray($row.pools , $index) ? ',' : '' }}
                        <span data-ng-if="$last && CdaUserListCtrl.isTruncatedPoolArray($row.pools , $index)">...</span>
                    </span>
        </oui-column>

        <oui-action-menu align="end" compact>
            <oui-action-menu-item text="{{'cda_user_edit_button_text' | translate}}"
                on-click="CdaUserListCtrl.viewPermissions($row.user.name)"></oui-action-menu-item>
            <oui-action-menu-divider></oui-action-menu-divider>
            <oui-action-menu-item text="{{'cda_user_delete_button_text' | translate}}"
                on-click="CdaUserListCtrl.openDeleteModal($row)"></oui-action-menu-item>
        </oui-action-menu>
    </oui-datagrid>
</section>
