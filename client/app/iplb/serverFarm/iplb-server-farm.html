<section class="cui-page__content">
    <cui-page-content-title text="'iplb_farm_title' | translate"></cui-page-content-title>
    <p data-translate="iplb_farm_intro_text"></p>

    <a class="oui-button oui-button_secondary"
        data-ui-sref="network.iplb.detail.server-farm.add"
        data-translate="iplb_farm_add"></a>

    <oui-spinner data-ng-if="ctrl.farms.loading"></oui-spinner>
    <cui-accordion data-ng-if="!ctrl.farms.loading"
        data-title="ctrl.getFarmName(farm)"
        data-text="ctrl.getFarmText(farm)"
        data-ng-repeat="farm in ctrl.farms.data track by $index"
        data-expanded=":: $first"
        data-actions="ctrl.farmActions[farm.farmId]">
        <a class="oui-button oui-button_secondary"
            data-translate="iplb_farm_add_server"
            data-ui-sref="network.iplb.detail.server-farm.server-add({ farmId: farm.farmId })"></a>

        <oui-spinner data-ng-show="!farm.servers || farm.servers.loading"></oui-spinner>
        <oui-datagrid rows="farm.servers.data">
            <oui-column title="'iplb_farm_server_list_col_server' | translate" property="serverId" sortable>
                {{ $row.displayName || $row.serverId }}
            </oui-column>
            <oui-column title="'iplb_farm_server_list_col_ipv4' | translate" property="address" sortable></oui-column>
            <oui-column title="'iplb_farm_server_list_col_active' | translate" property="status" sortable class="oui-table__cell_action">
                <label class="oui-switch">
                    <input type="checkbox" class="oui-switch__checkbox" data-ng-checked="$row.status === 'active'" data-ng-click="ctrl.toggle(farm, $row)">
                    <div class="oui-switch__slider"></div>
                    <i class="oui-icon oui-icon-success" aria-hidden="true"></i>
                    <i class="oui-icon oui-icon-error" aria-hidden="true"></i>
                </label>
            </oui-column>
            <oui-column title="'iplb_farm_server_list_col_status' | translate" property="serverState" sortable>
                <iplb-server-status data-server="$row"
                    tabindex="0"
                    role="button"
                    data-ng-click="ctrl.seeServerStatus($row)"></iplb-server-status>
            </oui-column>
            <oui-action-menu align="end" compact>
                <oui-action-menu-item text="{{'common_preview_see' | translate}}"
                    on-click="ctrl.seeServerPreview($row)"></oui-action-menu-item>
                <oui-action-menu-item text="{{'iplb_farm_server_status_see' | translate}}"
                    on-click="ctrl.seeServerStatus($row)"></oui-action-menu-item>
                <oui-action-menu-divider></oui-action-menu-divider>
                <oui-action-menu-item text="{{'common_modify' | translate}}"
                    on-click="ctrl.updateServer(farm.farmId, $row.serverId)"></oui-action-menu-item>
                <oui-action-menu-item text="{{'common_remove' | translate}}"
                    on-click="ctrl.deleteServer($row)"></oui-action-menu-item>
            </oui-action-menu>
        </oui-datagrid>
    </cui-accordion>
</section>
